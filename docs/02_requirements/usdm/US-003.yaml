id: US-003
title: ランダム譜面生成とリプレイ同一譜面
persona: 20代男性 Web系エンジニア（ライトゲーマー）
story: |
  私は毎回新鮮な体験を求めるライトゲーマーとして
  同じ曲でもプレイするたびに異なる譜面で遊びたい
  ただし直後に「リプレイ」ボタンを押した場合は
  先ほどと全く同じ譜面で再挑戦したい
  なぜなら比較的短時間でリズムスキル向上を実感しつつ
  飽きずに繰り返し楽しみたいからだ
acceptance_criteria: |
  Feature: ランダム譜面生成 & シード保持
    Scenario: 初回プレイはランダム譜面
      Given ユーザが曲を選択し初めて「Play」を押す
      Then 譜面がランダムに生成され プレイが開始される

    Scenario: 連続リプレイは同一譜面
      Given プレイ終了後リザルト画面にいる
      When ユーザが「Replay」を押す
      Then 直前と同一の譜面シードが適用され 同じ譜面で再度プレイが開始される

    Scenario: 別セッションでは新しい譜面
      Given リザルト画面を閉じトップページへ戻った
      When 同じ曲の URL を再度入力し「Play」を押す
      Then 前回とは異なるランダムシードが用いられ 新しい譜面でプレイが開始される
notes: |
  ・譜面生成アルゴリズムはランダムシード入力を受付けること
  ・リプレイ時は前回シードを一時メモリに保持し再利用